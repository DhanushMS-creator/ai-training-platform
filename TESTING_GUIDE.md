<!-- @format -->

# 🧪 Testing Guide - AI Training Platform

## Quick Test Checklist

### ✅ Phase 1: Backend Setup Tests

#### 1. Installation Test

```bash
cd backend
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
```

**Expected**: All packages install without errors

#### 2. Database Migration Test

```bash
python manage.py makemigrations
python manage.py migrate
```

**Expected**:

- Migrations created for users and assessments apps
- All tables created successfully

#### 3. Admin Panel Test

```bash
python manage.py createsuperuser
# Enter username, email, password
python manage.py runserver
```

**Access**: http://localhost:8000/admin

**Expected**: Login successful, see models in admin

---

### ✅ Phase 2: API Endpoint Tests

#### Test 1: Registration API

**Request**:

```bash
curl -X POST http://localhost:8000/api/users/register/ \
  -H "Content-Type: application/json" \
  -d "{
    \"name\": \"Test User\",
    \"email\": \"test@example.com\",
    \"job_title\": \"Software Developer\",
    \"industry\": \"Technology\",
    \"company\": \"Test Corp\"
  }"
```

**Expected Response**:

```json
{
	"trainee_id": 1,
	"session_id": 1,
	"name": "Test User",
	"job_title": "Software Developer",
	"industry": "Technology",
	"message": "Registration successful"
}
```

**Verify**:

- Check Django admin for new Trainee record
- Check for new TrainingSession record
- Status should be "registration"

#### Test 2: Get Session

**Request**:

```bash
curl http://localhost:8000/api/users/sessions/1/
```

**Expected Response**:

```json
{
	"id": 1,
	"trainee": 1,
	"trainee_name": "Test User",
	"status": "registration",
	"video_url": null,
	"video_completed": false,
	"mcq_score": null,
	"mcq_total": null,
	"started_at": "2025-10-15T10:30:00Z",
	"completed_at": null
}
```

#### Test 3: Update Session Status

**Request**:

```bash
curl -X POST http://localhost:8000/api/users/sessions/1/status/ \
  -H "Content-Type: application/json" \
  -d "{\"status\": \"video\"}"
```

**Expected Response**:

```json
{
	"session_id": 1,
	"status": "video",
	"message": "Status updated to video"
}
```

#### Test 4: MCQ Generation (with PDF)

**Prepare**: Get a sample PDF file (training_material.pdf)

**Request**:

```bash
curl -X POST http://localhost:8000/api/assessments/sessions/1/generate/ \
  -F "pdf_file=@C:\path\to\training_material.pdf" \
  -F "num_questions=5"
```

**Expected Response**:

```json
{
	"session_id": 1,
	"questions": [
		{
			"id": 1,
			"question_text": "What is the primary purpose of...",
			"option_a": "Option A text",
			"option_b": "Option B text",
			"option_c": "Option C text",
			"option_d": "Option D text"
		}
		// ... 4 more questions
	],
	"total_questions": 5
}
```

**Verify**:

- Check Django admin for 5 new MCQQuestion records
- Session status updated to "mcq"
- mcq_total set to 5
- correct_answer field populated (but not in API response)

#### Test 5: Get Questions

**Request**:

```bash
curl http://localhost:8000/api/assessments/sessions/1/questions/
```

**Expected**: Same questions without correct_answer field

#### Test 6: Submit Answer

**Request**:

```bash
curl -X POST http://localhost:8000/api/assessments/sessions/1/answer/ \
  -H "Content-Type: application/json" \
  -d "{
    \"question_id\": 1,
    \"selected_answer\": \"B\"
  }"
```

**Expected Response**:

```json
{
	"id": 1,
	"question": 1,
	"question_text": "What is...",
	"selected_answer": "B",
	"is_correct": true, // or false
	"answered_at": "2025-10-15T11:00:00Z"
}
```

**Verify**:

- MCQAnswer record created
- is_correct automatically validated

#### Test 7: Submit Exam

**Prerequisite**: Answer at least one question

**Request**:

```bash
curl -X POST http://localhost:8000/api/assessments/sessions/1/submit/
```

**Expected Response**:

```json
{
	"score": 3,
	"total": 5,
	"percentage": 60.0,
	"feedback": "Dear Test User, Thank you for completing the training assessment. As a Software Developer in the Technology industry, you've demonstrated good understanding...",
	"questions_review": [
		{
			"id": 1,
			"question_text": "...",
			"option_a": "...",
			"correct_answer": "B",
			"explanation": "..."
		}
		// ... all questions with answers revealed
	]
}
```

**Verify**:

- Session status updated to "feedback"
- mcq_score and mcq_total updated
- Personalized feedback generated by Gemini

---

### ✅ Phase 3: Frontend Tests

#### Test 1: Frontend Installation

```bash
cd frontend
npm install
npm start
```

**Expected**:

- Dependencies install successfully
- Dev server starts on http://localhost:3000
- Page loads (may show errors due to incomplete routing)

#### Test 2: Registration Form

**Steps**:

1. Go to http://localhost:3000
2. Fill in all fields:
   - Name: "John Doe"
   - Email: "john@example.com"
   - Job Title: "Marketing Manager"
   - Industry: "Healthcare"
   - Company: "Health Corp" (optional)
3. Click "Begin Training"

**Expected**:

- Form validates all required fields
- Loading state shows during submission
- On success:
  - trainee_id stored in localStorage
  - session_id stored in localStorage
  - Attempt to navigate to /greeting/{sessionId}
  - Error if greeting page not built yet (expected)

**Verify Backend**:

- Check Django admin for new Trainee
- Check new TrainingSession created

#### Test 3: API Service Functions

**In browser console** (F12):

```javascript
// Import API functions
import { registerTrainee, getSession } from "./services/api";

// Test registration
const data = {
	name: "Console Test",
	email: "console@test.com",
	job_title: "Tester",
	industry: "QA",
};

registerTrainee(data).then(console.log).catch(console.error);
```

**Expected**: Console logs the response or error

---

### ✅ Phase 4: Integration Tests

#### Full Flow Test

**Scenario**: Complete user journey from registration to results

1. **Register**:

   ```bash
   curl -X POST http://localhost:8000/api/users/register/ \
     -H "Content-Type: application/json" \
     -d "{\"name\":\"Flow Test\",\"email\":\"flow@test.com\",\"job_title\":\"Analyst\",\"industry\":\"Finance\"}"
   ```

   Note the session_id

2. **Update to Video**:

   ```bash
   curl -X POST http://localhost:8000/api/users/sessions/{session_id}/status/ \
     -H "Content-Type: application/json" \
     -d "{\"status\":\"video\"}"
   ```

3. **Mark Video Complete**:

   ```bash
   curl -X PATCH http://localhost:8000/api/users/sessions/{session_id}/ \
     -H "Content-Type: application/json" \
     -d "{\"video_completed\":true}"
   ```

4. **Generate MCQs**:

   ```bash
   curl -X POST http://localhost:8000/api/assessments/sessions/{session_id}/generate/ \
     -F "pdf_file=@test.pdf" \
     -F "num_questions=3"
   ```

5. **Answer Questions**:

   ```bash
   # Answer Q1
   curl -X POST http://localhost:8000/api/assessments/sessions/{session_id}/answer/ \
     -H "Content-Type: application/json" \
     -d "{\"question_id\":1,\"selected_answer\":\"A\"}"

   # Answer Q2
   curl -X POST http://localhost:8000/api/assessments/sessions/{session_id}/answer/ \
     -H "Content-Type: application/json" \
     -d "{\"question_id\":2,\"selected_answer\":\"B\"}"

   # Answer Q3
   curl -X POST http://localhost:8000/api/assessments/sessions/{session_id}/answer/ \
     -H "Content-Type: application/json" \
     -d "{\"question_id\":3,\"selected_answer\":\"C\"}"
   ```

6. **Submit Exam**:
   ```bash
   curl -X POST http://localhost:8000/api/assessments/sessions/{session_id}/submit/
   ```

**Expected**: Complete session with score and feedback

---

### ✅ Phase 5: Error Handling Tests

#### Test Invalid Data

1. **Missing Required Fields**:

   ```bash
   curl -X POST http://localhost:8000/api/users/register/ \
     -H "Content-Type: application/json" \
     -d "{\"name\":\"Test\"}"
   ```

   **Expected**: 400 Bad Request with field errors

2. **Duplicate Email**:

   ```bash
   # Register once
   curl -X POST http://localhost:8000/api/users/register/ \
     -H "Content-Type: application/json" \
     -d "{\"name\":\"User1\",\"email\":\"dup@test.com\",\"job_title\":\"Dev\",\"industry\":\"Tech\"}"

   # Register again with same email
   curl -X POST http://localhost:8000/api/users/register/ \
     -H "Content-Type: application/json" \
     -d "{\"name\":\"User2\",\"email\":\"dup@test.com\",\"job_title\":\"Dev\",\"industry\":\"Tech\"}"
   ```

   **Expected**: 400 Bad Request - email already exists

3. **Invalid Session ID**:

   ```bash
   curl http://localhost:8000/api/users/sessions/99999/
   ```

   **Expected**: 404 Not Found

4. **Generate MCQs Without PDF**:

   ```bash
   curl -X POST http://localhost:8000/api/assessments/sessions/1/generate/ \
     -F "num_questions=5"
   ```

   **Expected**: 400 Bad Request - PDF required

5. **Answer Non-existent Question**:
   ```bash
   curl -X POST http://localhost:8000/api/assessments/sessions/1/answer/ \
     -H "Content-Type: application/json" \
     -d "{\"question_id\":99999,\"selected_answer\":\"A\"}"
   ```
   **Expected**: 404 Not Found

---

### ✅ Phase 6: Performance Tests

#### Test MCQ Generation Speed

**Time the request**:

```bash
time curl -X POST http://localhost:8000/api/assessments/sessions/1/generate/ \
  -F "pdf_file=@test.pdf" \
  -F "num_questions=10"
```

**Expected**:

- 10 questions: 10-20 seconds
- Depends on Gemini API response time

#### Test Multiple Concurrent Requests

**Use Apache Bench** (if installed):

```bash
ab -n 100 -c 10 http://localhost:8000/api/users/sessions/1/
```

**Expected**: All requests complete successfully

---

### ✅ Phase 7: AI Quality Tests

#### Test Gemini MCQ Generation

**Different Scenarios**:

1. **Tech Industry + Software PDF**:

   - Job: "Software Engineer"
   - Industry: "Technology"
   - PDF: Software development guide
   - **Expected**: Questions about coding, testing, architecture

2. **Healthcare + Compliance PDF**:

   - Job: "Nurse"
   - Industry: "Healthcare"
   - PDF: Medical compliance document
   - **Expected**: Questions about procedures, regulations

3. **Finance + Investment PDF**:
   - Job: "Financial Analyst"
   - Industry: "Finance"
   - PDF: Investment strategies
   - **Expected**: Questions about financial analysis, risk

**Verify**:

- Questions are contextually relevant
- Options are plausible
- Correct answers are accurate
- Explanations make sense

#### Test Feedback Generation

**Different Scores**:

1. **High Score (90%+)**:
   **Expected**: Congratulatory feedback, encouragement

2. **Medium Score (60-80%)**:
   **Expected**: Balanced feedback, specific improvement areas

3. **Low Score (<60%)**:
   **Expected**: Supportive feedback, detailed recommendations

**Verify**:

- Mentions trainee name
- References job title and industry
- Provides specific recommendations
- Professional tone

---

### 🐛 Common Issues & Solutions

#### Issue 1: "Module not found"

**Solution**:

```bash
pip install -r requirements.txt
# or
npm install
```

#### Issue 2: "Table doesn't exist"

**Solution**:

```bash
python manage.py migrate
```

#### Issue 3: "CORS error"

**Solution**: Check `settings.py`:

```python
CORS_ALLOWED_ORIGINS = [
    "http://localhost:3000",
]
```

#### Issue 4: "Gemini API error"

**Solution**:

- Check API key in `.env`
- Verify quota at https://ai.google.dev/
- Check model name: `gemini-2.0-flash-exp`

#### Issue 5: "PDF parsing failed"

**Solution**:

- Ensure PDF is not password-protected
- Check file size (keep under 10MB for testing)
- Try different PDF

#### Issue 6: "Port already in use"

**Solution**:

```bash
# Backend (change port)
python manage.py runserver 8001

# Frontend (change port)
set PORT=3001 && npm start
```

---

### 📊 Test Results Checklist

- [ ] Backend installs successfully
- [ ] Database migrations run
- [ ] Admin panel accessible
- [ ] Registration API works
- [ ] Session creation works
- [ ] MCQ generation works
- [ ] Answer submission works
- [ ] Exam submission works
- [ ] Feedback generation works
- [ ] Frontend installs successfully
- [ ] Registration form works
- [ ] Form validation works
- [ ] API calls succeed
- [ ] localStorage saves session
- [ ] Error handling works
- [ ] CORS configured correctly
- [ ] Gemini API responds
- [ ] PDF parsing works
- [ ] Questions are relevant
- [ ] Feedback is personalized

---

### 🚀 Next Steps After Testing

Once all tests pass:

1. **Build remaining components**:

   - AvatarGreeting
   - VideoPlayer
   - MCQFlow

2. **Add routing**:

   - Configure react-router-dom
   - Set up navigation flow

3. **Polish UI**:

   - Responsive design
   - Loading states
   - Error boundaries

4. **Prepare for deployment**:
   - Environment configuration
   - Production database
   - Security hardening

---

### 📝 Test Log Template

```
Date: ____________________
Tester: __________________

Backend Tests:
[ ] Installation
[ ] Migrations
[ ] Admin panel
[ ] Registration API
[ ] Session API
[ ] MCQ generation
[ ] Answer submission
[ ] Exam submission
[ ] Feedback generation

Frontend Tests:
[ ] Installation
[ ] Registration form
[ ] Form validation
[ ] API integration

Issues Found:
1. _______________________
2. _______________________
3. _______________________

Notes:
_________________________
_________________________
```

---

**Happy Testing!** 🧪✨
